function(t,e,i){"use strict";var n=t("../core/renderer"),s=t("../animation/fx"),o=t("../animation/translator"),a=t("../core/utils/math"),r=t("../core/utils/extend").extend,l=t("../core/utils/common").noop,d=t("../core/utils/dom"),c=t("../core/utils/type").isDefined,h=t("../core/devices"),m=t("../core/utils/dom").getPublicElement,u=t("../core/component_registrator"),p=t("./collection/ui.collection_widget.live_update").default,_=t("../events/gesture/swipeable"),f=t("../core/utils/deferred").Deferred,v="dx-multiview",I="dx-multiview-wrapper",w="dx-multiview-item-container",g="dx-multiview-item",C="dx-multiview-item-hidden",x="dxMultiViewItemData",b=200,E=function(t){return+t},S=function(t){return o.locate(t).left},y=function(t,e){o.move(t,{left:e})},$=function(t,e,i,n){s.animate(t,{type:"slide",to:{left:e},duration:i,complete:n})},B=function(t){s.stop(t,!0)},D=p.inherit({_activeStateUnit:".dx-multiview-item",_supportedKeys:function(){return r(this.callBase(),{pageUp:l,pageDown:l})},_getDefaultOptions:function(){return r(this.callBase(),{selectedIndex:0,swipeEnabled:!0,animationEnabled:!0,loop:!1,deferRendering:!0,_itemAttributes:{role:"tabpanel"},loopItemFocus:!1,selectOnFocus:!0,selectionMode:"single",selectionRequired:!0,selectionByClick:!1})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===h.real().deviceType&&!h.isSimulator()},options:{focusStateEnabled:!0}}])},_itemClass:function(){return"dx-multiview-item"},_itemDataKey:function(){return"dxMultiViewItemData"},_itemContainer:function(){return this._$itemContainer},_itemElements:function(){return this._itemContainer().children(this._itemSelector())},_itemWidth:function(){return this._itemWidthValue||(this._itemWidthValue=this._$wrapper.width()),this._itemWidthValue},_clearItemWidthCache:function(){delete this._itemWidthValue},_itemsCount:function(){return this.option("items").length},_normalizeIndex:function(t){var e=this._itemsCount();return t<0&&(t+=e),t>=e&&(t-=e),t},_getRTLSignCorrection:function(){return this.option("rtlEnabled")?-1:1},_init:function(){this.callBase.apply(this,arguments);var t=this.$element();t.addClass("dx-multiview"),this._$wrapper=n("<div>").addClass("dx-multiview-wrapper"),this._$wrapper.appendTo(t),this._$itemContainer=n("<div>").addClass("dx-multiview-item-container"),this._$itemContainer.appendTo(this._$wrapper),this.option("loopItemFocus",this.option("loop")),this._initSwipeable()},_initMarkup:function(){this._deferredItems=[],this.callBase()},_afterItemElementDeleted:function(t,e){if(this.callBase(t,e),this._deferredItems&&(this._deferredItems.splice(e.itemIndex,1),this.option("items")))for(var i=e.itemIndex;i<this.option("items").length;i++){var n=this.option("items")[i],s=this._findItemElementByItem(n);if(!s.length)break;this._refreshItem(s,n)}},_renderItemContent:function(t){var e=new f,i=this,n=this.callBase,s=new f;return s.done(function(){var s=n.call(i,t);e.resolve(s)}),this._deferredItems[t.index]=s,this.option("deferRendering")||s.resolve(),e.promise()},_render:function(){this.callBase();var t=this._getSelectedItemIndices();this._updateItemsPosition(t[0]),this._updateItemsVisibility(t[0])},_renderSelection:function(t){this._updateItemsVisibility(t[0])},_updateItems:function(t,e){this._updateItemsPosition(t,e),this._updateItemsVisibility(t,e)},_updateItemsPosition:function(t,e){var i=this._itemElements(),n=c(e)?-this._animationDirection(e,t):void 0,s=i.eq(t);y(s,0),c(e)&&y(i.eq(e),100*n+"%")},_updateItemsVisibility:function(t,e){var i;this._itemElements().each(function(i,s){var o=n(s),a=i!==t&&i!==e;a||this._renderSpecificItem(i),o.toggleClass("dx-multiview-item-hidden",a),this.setAria("hidden",a||void 0,o)}.bind(this))},_renderSpecificItem:function(t){var e=this._itemElements().eq(t),i=e.find(this._itemContentClass()).length>0;c(t)&&!i&&(this._deferredItems[t].resolve(),d.triggerResizeEvent(e))},_refreshItem:function(t,e){this.callBase(t,e),this._updateItemsVisibility(this.option("selectedIndex"))},_setAriaSelected:l,_updateSelection:function(t,e){var i=t[0],n=e[0];B(this._$itemContainer),this._updateItems(n,i);var s=this._animationDirection(i,n);this._animateItemContainer(s*this._itemWidth(),function(){y(this._$itemContainer,0),this._updateItems(i),this._$itemContainer.width()}.bind(this))},_animateItemContainer:function(t,e){var i=this.option("animationEnabled")?200:0;$(this._$itemContainer,t,i,e)},_animationDirection:function(t,e){var i=S(this._$itemContainer),n=(e-t)*this._getRTLSignCorrection()*this._getItemFocusLoopSignCorrection(),s,o=0!==i?i:n;return a.sign(o)},_initSwipeable:function(){this._createComponent(this.$element(),_,{disabled:!this.option("swipeEnabled"),elastic:!1,itemSizeFunc:this._itemWidth.bind(this),onStart:function(t){this._swipeStartHandler(t.event)}.bind(this),onUpdated:function(t){this._swipeUpdateHandler(t.event)}.bind(this),onEnd:function(t){this._swipeEndHandler(t.event)}.bind(this)})},_swipeStartHandler:function(t){B(this._$itemContainer);var e=this.option("selectedIndex"),i=this.option("loop"),n=this._itemsCount()-1,s=this.option("rtlEnabled");t.maxLeftOffset=E(i||(s?e>0:e<n)),t.maxRightOffset=E(i||(s?e<n:e>0)),this._swipeDirection=null},_swipeUpdateHandler:function(t){var e=t.offset,i=a.sign(e)*this._getRTLSignCorrection();if(y(this._$itemContainer,e*this._itemWidth()),i!==this._swipeDirection){this._swipeDirection=i;var n=this.option("selectedIndex"),s=this._normalizeIndex(n-i);this._updateItems(n,s)}},_swipeEndHandler:function(t){var e=t.targetOffset*this._getRTLSignCorrection();if(e){this.option("selectedIndex",this._normalizeIndex(this.option("selectedIndex")-e));var i=this.itemElements().filter(".dx-item-selected");this.option("focusStateEnabled")&&this.option("focusedElement",m(i))}else this._animateItemContainer(0,l)},_getItemFocusLoopSignCorrection:function(){return this._itemFocusLooped?-1:1},_moveFocus:function(){this.callBase.apply(this,arguments),this._itemFocusLooped=!1},_prevItem:function(t){var e=this.callBase.apply(this,arguments);return this._itemFocusLooped=e.is(t.last()),e},_nextItem:function(t){var e=this.callBase.apply(this,arguments);return this._itemFocusLooped=e.is(t.first()),e},_dimensionChanged:function(){this._clearItemWidthCache()},_visibilityChanged:function(t){t&&this._dimensionChanged()},_optionChanged:function(t){var e=t.value;switch(t.name){case"loop":this.option("loopItemFocus",e);break;case"animationEnabled":break;case"swipeEnabled":_.getInstance(this.$element()).option("disabled",!e);break;case"deferRendering":this._invalidate();break;default:this.callBase(t)}}});u("dxMultiView",D),i.exports=D,i.exports.default=i.exports}

