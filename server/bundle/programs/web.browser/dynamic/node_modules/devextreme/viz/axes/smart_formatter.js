function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.smartFormatter=B,t.formatRange=E;var n,r=s(e("../../format_helper")),i=e("../../core/utils/type"),a,o=s(e("../../core/utils/date")),f=e("../../core/utils/math"),u=e("../core/utils");function s(e){return e&&e.__esModule?e:{default:e}}var l=r.default.format,c=Math.floor,d=Math.abs,g="exponential",h=["fixedPoint","thousands","millions","billions","trillions",g],m=["millisecond","second","minute","hour","day","month","year"];function p(e,t,n,r){var i,a,f,u,s,l,c=m.length;if("week"===r?r="day":"quarter"===r?r="month":"shorttime"===r?r="hour":"longtime"===r&&(r="second"),u=m.indexOf(r),n){if(a=o.default.getDatesDifferences(t,n),i=o.default.getDatesDifferences(t,e),a[r])for(s=c-1;s>=u;s--)if(f=m[s],s===u)D(a,u+(a.millisecond?2:1));else if(a[f]){y(a,s);break}}else for(i=o.default.getDatesDifferences(e,t),s=c-1;s>=u;s--)if(i[f=m[s]]){if(s-u>1){for(l=u+1;l>=0;l--)y(i,l);break}if(v(t,f)){for(l=s-1;l>0;l--)y(i,l);break}}return n?a:i}function v(e,t){var n,r=[e.getMilliseconds(),e.getSeconds(),e.getMinutes(),e.getHours(),e.getDate(),e.getMonth()],i=m.indexOf(t);for(n=0;n<i;n++)if(4===n&&1!==r[n]||4!==n&&0!==r[n])return!1;return!0}function y(e,t){var n=m[t];e[n]&&(e[n]=!1,e.count--)}function D(e,t){var n=m[t];!1===e[n]&&(e[n]=!0,e.count++)}function x(e){return e.length-parseInt(e).toString().length}function k(e,t){var n,r,i,a=0;for(i=d(t-e[0]),n=1;n<e.length;n++)(r=d(t-e[n]))<i&&(i=r,a=n);return a}function b(e){return e.toString().split(".")}function O(e){var t=void 0;return(0,i.isFunction)(e)&&(t=e,e=null),{type:e,formatter:t}}function B(e,t){var n,a,s,m,v,y,D,B,j,F=t.tickInterval,M=d(e).toString(),T=0,E=0,_=0,I=-1,P=t.labelOptions.format,S=t.ticks,w="logarithmic"===t.type;return 1!==S.length||0!==S.indexOf(e)||(0,i.isDefined)(F)||(F=d(e)>=1?1:(0,f.adjust)(1-d(e),e)),(0,i.isDefined)(P)||"discrete"===t.type||!e||10!==t.logarithmBase&&w||("datetime"!==t.dataType&&(0,i.isDefined)(F)?(S.length&&-1===S.indexOf(e)&&(I=k(S,e),F=(0,f.adjust)(d(e-S[I]),e)),(v=b(F))<2&&(v=b(e)),w?(D=(0,u.getAdjustedLog10)(d(e)))>0?m=h[c(D/3)]||g:D<-4?m=g:T=void 0:v.length>1&&!(0,i.isExponential)(F)?(T=v[1].length,m=h[_]):(0,i.isExponential)(F)&&(-1!==M.indexOf(".")||(0,i.isExponential)(e))?(m=g,T=(0,i.isExponential)(e)?Math.max(d((0,f.getExponent)(e)-(0,f.getExponent)(F)),d((0,f.getPrecision)(e)-(0,f.getPrecision)(F))):d(x(M.split(".")[1])-(0,f.getExponent)(F)+1)):(n=c((0,u.getAdjustedLog10)(F)),s=a=c((0,u.getAdjustedLog10)(d(e))),a-n>=2&&(s=n),E=3*(_=c(s/3)),_<5?(n-E==2&&a>=3&&(E=3*++_),m=h[_]):m=h[h.length-1],E>0&&(v=b(F/Math.pow(10,E)))[1]&&(T=v[1].length)),void 0===m&&void 0===T||(P={type:m,precision:T})):"datetime"===t.dataType&&(m=o.default.getDateFormatByTickInterval(F),t.showTransition&&S.length&&(I=S.map(Number).indexOf(+e),1===S.length&&0===I?m=r.default.getDateFormatByTicks(S):(-1===I?B=k(S,e):(B=0===I?S.length-1:I-1,j=0===I?1:-1),y=p(S[B],e,S[j],m),m=r.default.getDateFormatByDifferences(y,m))),P=O(m))),l(e,P)}function j(e){var t=!1;for(var n in e)!0===e[n]||"hour"===n||t?(e[n]=!1,t=!0):!1===e[n]&&(e[n]=!0);return O(r.default.getDateFormatByDifferences(e))}function F(e,t){var n=!1;for(var i in e)n?e[i]=!1:i===t?n=!0:e[i]=!0;return O(r.default.getDateFormatByDifferences(e))}function M(e,t,n){var i=p(e,t),a=o.default.getDateFormatByTickInterval(n),f,u=O(r.default.getDateFormatByDifferences(i,a)),s=[];if(n in i){var c=F(p(e,t),n),d=l(e,c);d&&s.push(d)}else{var g=j(p(e,t)),h=l(e,g);h&&s.push(h),s.push(l(e,u)+" - "+l(t,u))}return s.join(", ")}function T(e){if((0,i.isObject)(e)){var t=Object.keys(e),n;if(1===t.reduce(function(t,n){return e[n]+t},0)){var r=t.filter(function(t){return 1===e[t]})[0];return r.slice(0,r.length-1)}}return e}function E(e,t,n,r){var i=r.dataType,a=r.type,o=r.logarithmBase;if("discrete"===a)return"";if("datetime"===i)return M(e,t,T(n));var f={ticks:[],type:a,dataType:i,tickInterval:n,logarithmBase:o,labelOptions:{}};return B(e,f)+" - "+B(t,f)}}

