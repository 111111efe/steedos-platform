function(e){"use strict";var t,n=s(e("./ui.tree_list.core")),r=e("../../core/utils/extend"),o=e("../../core/utils/deferred"),i,a=s(e("../grid_core/ui.grid_core.focus"));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n=-1;return e.forEach(function(e,r){t(e)&&(n=r)}),n}n.default.registerModule("focus",(0,r.extend)(!0,{},a.default,{extenders:{controllers:{data:{changeRowExpand:function(e){return this.option("focusedRowEnabled")&&this.isRowExpanded(e)&&this._isFocusedRowInside(e)&&this.option("focusedRowKey",e),this.callBase.apply(this,arguments)},_isFocusedRowInside:function(e){for(var t=this.option("focusedRowKey"),n=this.getRowIndexByKey(t),r=n>=0&&this.getVisibleRows()[n],o=r&&r.node.parent;o;){if(o.key===e)return!0;o=o.parent}return!1},getParentKey:function(e){var t=this,n=this._dataSource,r=this.getNodeByKey(e),i=new o.Deferred;return r?i.resolve(r.parent?r.parent.key:void 0):n.load({filter:[n.getKeyExpr(),"=",e]}).done(function(e){var t=e[0];t?i.resolve(n.parentKeyOf(t)):i.reject()}).fail(i.reject),i.promise()},expandAscendants:function(e){var t=this,n=t._dataSource,r=new o.Deferred;return t.getParentKey(e).done(function(e){n&&void 0!==e&&e!==t.option("rootValue")?(n._isNodesInitializing=!0,t.expandRow(e),n._isNodesInitializing=!1,t.expandAscendants(e).done(r.resolve).fail(r.reject)):r.resolve()}).fail(r.reject),r.promise()},getPageIndexByKey:function(e){var t=this,n=t._dataSource,r=new o.Deferred;return t.expandAscendants(e).done(function(){n.load({filter:t.getCombinedFilter(),sort:t.getController("columns").getSortDataSourceParameters(!n.remoteOperations().sorting),parentIds:[]}).done(function(n){var o=d(n,function(n){return t.keyOf(n.data)===e}),i=t.pageIndex();o>=0&&(i=Math.floor(o/t.pageSize())),r.resolve(i)}).fail(r.reject)}).fail(r.reject),r.promise()}}}}}))}

