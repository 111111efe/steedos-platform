function(e,t,n){"use strict";var i,o=g(e("../../core/renderer")),r,l=g(e("../../events/core/events_engine")),a,s=g(e("./ui.grid_core.columns_view")),d,u=g(e("../../localization/message")),c=e("../../core/utils/type"),h=e("../../core/utils/iterator"),m=e("../../core/utils/extend");function g(e){return e&&e.__esModule?e:{default:e}}var f="text-content",C="headers",p="nowrap",w="dx-header-row",_="dx-column-lines",x="context-menu-sort-asc",v="context-menu-sort-desc",y="context-menu-sort-none",b="dx-cell-focus-disabled",T="dx-visibility-hidden",R="dx-text-content-alignment-",B="dx-sort-indicator",E="dx-header-filter-indicator",I="dx-header-multi-row",H,D;n.exports={defaultOptions:function(){return{showColumnHeaders:!0,cellHintEnabled:!0}},views:{columnHeadersView:s.default.ColumnsView.inherit((H=function(e,t,n){var i,r=(0,o.default)("<div>").addClass(e.addWidgetPrefix("text-content"));return e.setAria("role","presentation",r),D(e,t,n.column,r),r[(i=e.option("showColumnLines"))||"right"===n.column.alignment?"appendTo":"prependTo"](t)},D=function(e,t,n,i){var o=e._getIndicatorElements(t,!0),r=e._getIndicatorElements(t),l=o&&o.length,a=e._getColumnAlignment(n.alignment);(i=i||t.children("."+e.addWidgetPrefix("text-content"))).toggleClass("dx-text-content-alignment-"+a,l>0).toggleClass("dx-text-content-alignment-"+("left"===a?"right":"left"),l>0&&"center"===n.alignment).toggleClass("dx-sort-indicator",!!r.filter("."+e._getIndicatorClassName("sort")).length).toggleClass("dx-header-filter-indicator",!!r.filter("."+e._getIndicatorClassName("headerFilter")).length)},{_createTable:function(){var e=this.callBase.apply(this,arguments);return l.default.on(e,"mousedown selectstart",this.createAction(function(e){var t=e.event;t.shiftKey&&t.preventDefault()})),e},_getDefaultTemplate:function(e){var t=this;return function(n,i){var o=e.command?n:H(t,n,i),r="expand"!==e.command&&e.caption;r?o.text(r):e.command&&n.html("&nbsp;")}},_getHeaderTemplate:function(e){return e.headerCellTemplate||{allowRenderToDetachedContainer:!0,render:this._getDefaultTemplate(e)}},_processTemplate:function(e,t){var n,i=this,o=t.column,r=i.callBase(e);return n="header"===t.rowType&&r&&o.headerCellTemplate&&!o.command?{render:function(e){var t=H(i,e.container,e.model);r.render((0,m.extend)({},e,{container:t}))}}:r},_handleDataChanged:function(e){"refresh"===e.changeType&&(this._isGroupingChanged||this._requireReady)&&(this._isGroupingChanged=!1,this.render())},_renderCell:function(e,t){var n=this.callBase(e,t);return"header"===t.row.rowType&&n.addClass("dx-cell-focus-disabled"),n},_setCellAriaAttributes:function(e,t){this.callBase(e,t),"header"===t.rowType&&(this.setAria("role","columnheader",e),!t.column||t.column.command||t.column.isBand||(e.attr("id",t.column.headerId),this.setAria("label",u.default.format("dxDataGrid-ariaColumn")+" "+t.column.caption,e)))},_createRow:function(e){var t=this.callBase(e).toggleClass("dx-column-lines",this.option("showColumnLines"));return"header"===e.rowType&&t.addClass("dx-header-row"),t},_renderCore:function(){var e=this,t=this.element();(!this._tableElement||this._dataController.isLoaded()||this._hasRowElements)&&(t.addClass(this.addWidgetPrefix("headers")).toggleClass(this.addWidgetPrefix("nowrap"),!this.option("wordWrapEnabled")).empty(),this.setAria("role","presentation",t),this._updateContent(this._renderTable()),this.getRowCount()>1&&t.addClass("dx-header-multi-row"),this.callBase.apply(this,arguments))},_renderRows:function(){var e=this;(this._dataController.isLoaded()||this._hasRowElements)&&(this.callBase.apply(this,arguments),this._hasRowElements=!0)},_getRowVisibleColumns:function(e){return this._columnsController.getVisibleColumns(e)},_renderRow:function(e,t){t.columns=this._getRowVisibleColumns(t.row.rowIndex),this.callBase(e,t)},_createCell:function(e){var t=e.column,n=this.callBase.apply(this,arguments);return t.rowspan>1&&"header"===e.rowType&&n.attr("rowSpan",t.rowspan),n},_getRows:function(){var e,t=[],n=this.getRowCount();if(this.option("showColumnHeaders"))for(e=0;e<n;e++)t.push({rowType:"header",rowIndex:e});return t},_getCellTemplate:function(e){if("header"===e.rowType)return this._getHeaderTemplate(e.column)},_columnOptionChanged:function(e){var t=e.changeTypes,n=e.optionNames;t.grouping?this._isGroupingChanged=!0:(this.callBase(e),(n.width||n.visible)&&this.resizeCompleted.fire())},_isElementVisible:function(e){return e&&e.visible},_alignCaptionByCenter:function(e){var t=this._getIndicatorContainer(e,!0);t&&t.length&&(t.filter(".dx-visibility-hidden").remove(),(t=this._getIndicatorContainer(e)).clone().addClass("dx-visibility-hidden").css("float","").insertBefore(e.children("."+this.addWidgetPrefix("text-content"))))},_updateCell:function(e,t){"header"===t.rowType&&"center"===t.column.alignment&&this._alignCaptionByCenter(e),this.callBase.apply(this,arguments)},_updateIndicator:function(e,t,n){var i=this.callBase.apply(this,arguments);return"center"===t.alignment&&this._alignCaptionByCenter(e),D(this,e,t),i},_getIndicatorContainer:function(e,t){var n=this.callBase(e);return t?n:n.filter(":not(.dx-visibility-hidden)")},_isSortableElement:function(){return!0},getHeadersRowHeight:function(){var e=this._getTableElement(),t=e&&e.find(".dx-header-row");return t&&t.toArray().reduce(function(e,t){return e+(0,o.default)(t).height()},0)||0},getHeaderElement:function(e){var t=this.getColumnElements();return t&&t.eq(e)},getColumnElements:function(e,t){var n,i,r,l,a=this,s=a._columnsController,d=a.getRowCount();if(a.option("showColumnHeaders")){if(d>1&&(!(0,c.isDefined)(e)||(0,c.isDefined)(t)))return i=[],l=(0,c.isDefined)(t)?s.getChildrenByBandColumn(t,!0):s.getVisibleColumns(),(0,h.each)(l,function(t,o){n=(0,c.isDefined)(e)?e:s.getRowIndex(o.index),(r=a._getCellElement(n,s.getVisibleIndex(o.index,n)))&&i.push(r.get(0))}),(0,o.default)(i);if(!e||e<d)return a.getCellElements(e||0)}},getVisibleColumnIndex:function(e,t){var n=this.getColumns()[e];return n?this._columnsController.getVisibleIndex(n.index,t):-1},getColumnWidths:function(){var e=this.getColumnElements();return e&&e.length?this._getWidths(e):this.callBase.apply(this,arguments)},allowDragging:function(e,t,n){var i,o,r=e&&this._columnsController.getRowIndex(e.index),l=this.getColumns(0===r?0:null),a=0,s=function(e){return e.allowReordering||e.allowGrouping||e.allowHiding};for(i=0;i<l.length;i++)s(l[i])&&a++;if(a<=1)return!1;if(!n)return(this.option("allowColumnReordering")||this._columnsController.isColumnOptionUsed("allowReordering"))&&e&&e.allowReordering;for(i=0;i<n.length;i++)if((o=n[i])&&o.allowDragging(e,t))return!0;return!1},getBoundingRect:function(){var e,t=this,n=this.getColumnElements();return n&&n.length?{top:(e=this._getTableElement().offset()).top}:null},getName:function(){return"headers"},getColumnCount:function(){var e=this.getColumnElements();return e?e.length:0},isVisible:function(){return this.option("showColumnHeaders")},optionChanged:function(e){var t=this;switch(e.name){case"showColumnHeaders":case"wordWrapEnabled":case"showColumnLines":this._invalidate(!0,!0),e.handled=!0;break;default:this.callBase(e)}},getHeight:function(){return this.getElementHeight()},getContextMenuItems:function(e){var t,n,i=this,o=e.column;if(e.row&&("header"===e.row.rowType||"detailAdaptive"===e.row.rowType)&&(n=i.option("sorting"))&&"none"!==n.mode&&o&&o.allowSorting)return t=function(e){setTimeout(function(){i._columnsController.changeSortOrder(o.index,e.itemData.value)})},[{text:n.ascendingText,value:"asc",disabled:"asc"===o.sortOrder,icon:"context-menu-sort-asc",onItemClick:t},{text:n.descendingText,value:"desc",disabled:"desc"===o.sortOrder,icon:"context-menu-sort-desc",onItemClick:t},{text:n.clearText,value:"none",disabled:!o.sortOrder,icon:"context-menu-sort-none",onItemClick:t}]},getRowCount:function(){return this._columnsController&&this._columnsController.getRowCount()},setRowsOpacity:function(e,t,n){var i,o,r=this,l=r.getRowCount(),a=r._columnsController.getColumns(),s=a&&a[e],d=s&&s.isBand&&s.index,u=function(e,n){n.ownerBand===d&&(o.eq(e).css({opacity:t}),n.isBand&&r.setRowsOpacity(n.index,t,i+1))};if((0,c.isDefined)(d))for(i=n=n||0;i<l;i++)o=r.getCellElements(i),(0,h.each)(r.getColumns(i),u)}}))}}}

