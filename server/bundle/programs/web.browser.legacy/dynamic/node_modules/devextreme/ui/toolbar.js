function(e,t,i){"use strict";var n=e("../core/renderer"),o=e("./themes"),r=e("../core/component_registrator"),s=e("../core/utils/common").grep,a=e("../core/utils/extend").extend,u=e("../core/utils/array"),l=e("../core/utils/iterator"),h=e("./toolbar/ui.toolbar.strategy.action_sheet"),m=e("./toolbar/ui.toolbar.strategy.drop_down_menu"),c=e("./toolbar/ui.toolbar.strategy.list_bottom"),d=e("./toolbar/ui.toolbar.strategy.list_top"),_=e("./toolbar/ui.toolbar.base"),p=e("./widget/child_default_template"),g={actionSheet:h,dropDownMenu:m,listBottom:c,listTop:d},f="dx-toolbar-item-auto-hide",b="dx-toolbar-text-auto-hide",y="dx-toolbar-item-invisible",I=_.inherit({_getDefaultOptions:function(){return a(this.callBase(),{menuItemTemplate:"menuItem",submenuType:"dropDownMenu",menuContainer:void 0})},_defaultOptionsRules:function(){var e=o.current();return this.callBase().concat([{device:function(){return o.isIos7(e)},options:{submenuType:"actionSheet"}},{device:function(){return o.isAndroid5(e)},options:{submenuType:"dropDownMenu"}},{device:function(){return o.isWin8(e)},options:{submenuType:"listBottom"}},{device:function(){return o.isWin10(e)},options:{submenuType:"listTop"}}])},_dimensionChanged:function(e){"height"!==e&&(this._menuStrategy.toggleMenuVisibility(!1,!0),this.callBase(),this._menuStrategy.renderMenuItems())},_initTemplates:function(){this.callBase(),this._defaultTemplates.actionSheetItem=new p("item",this)},_initMarkup:function(){this.callBase(),this._renderMenu()},_postProcessRenderItems:function(){this._hideOverflowItems(),this._menuStrategy._updateMenuVisibility(),this.callBase(),this._menuStrategy.renderMenuItems()},_renderItem:function(e,t,i,n){var o=this.callBase(e,t,i,n);return"auto"===t.locateInMenu&&o.addClass("dx-toolbar-item-auto-hide"),"dxButton"===t.widget&&"inMenu"===t.showText&&o.toggleClass("dx-toolbar-text-auto-hide"),o},_getItemsWidth:function(){return this._getSummaryItemsWidth([this._$beforeSection,this._$centerSection,this._$afterSection])},_hideOverflowItems:function(e){var t=this.$element().find(".dx-toolbar-item-auto-hide");if(t.length){e=e||this.$element().width(),n(t).removeClass(y);for(var i=this._getItemsWidth();t.length&&e<i;){var o=t.eq(-1);i-=o.outerWidth(),o.addClass(y),t.splice(-1,1)}}},_getMenuItems:function(){var e=this,t=s(this.option("items")||[],function(t){return e._isMenuItem(t)}),i=this._itemContainer().children(".dx-toolbar-item-auto-hide."+y).not(".dx-state-invisible");this._restoreItems=this._restoreItems||[];var o=[].slice.call(i).map(function(t){var i=e._getItemData(t),o=n(t).children(),r=o.children();return a({menuItemTemplate:function(){var t;return e._restoreItems.push({container:o,item:r}),n("<div>").addClass("dx-toolbar-item-auto-hide").append(r)}},i)});return u.merge(o,t)},_getToolbarItems:function(){var e=this;return s(this.option("items")||[],function(t){return!e._isMenuItem(t)})},_renderMenu:function(){this._renderMenuStrategy(),this._menuStrategy.render()},_renderMenuStrategy:function(){var e=this.option("submenuType");this._requireDropDownStrategy()&&(e="dropDownMenu");var t=g[e];this._menuStrategy&&this._menuStrategy.NAME===e||(this._menuStrategy=new t(this))},_requireDropDownStrategy:function(){var e=this.option("submenuType");if(("listBottom"===e||"listTop"===e)&&"topToolbar"===this.option("renderAs"))return!0;var t=this.option("items")||[],i=!1;return l.each(t,function(e,t){"auto"===t.locateInMenu?i=!0:"always"===t.locateInMenu&&t.widget&&(i=!0)}),i},_arrangeItems:function(){if(!this.$element().is(":hidden")){this._$centerSection.css({margin:"0 auto",float:"none"}),l.each(this._restoreItems||[],function(e,t){n(t.container).append(t.item)}),this._restoreItems=[];var e=this.$element().width();this._hideOverflowItems(e),this.callBase(e)}},_itemOptionChanged:function(e,t,i){this._isMenuItem(e)?this._menuStrategy.renderMenuItems():this._isToolbarItem(e)?this.callBase(e,t,i):(this.callBase(e,t,i),this._menuStrategy.renderMenuItems())},_isMenuItem:function(e){return"menu"===e.location||"always"===e.locateInMenu},_isToolbarItem:function(e){return void 0===e.location||"never"===e.locateInMenu},_optionChanged:function(e){var t=e.name,i=e.value;switch(t){case"submenuType":this._invalidate();break;case"visible":this.callBase.apply(this,arguments),this._menuStrategy.handleToolbarVisibilityChange(i);break;case"menuItemTemplate":this._changeMenuOption("itemTemplate",this._getTemplate(i));break;case"onItemClick":this._changeMenuOption(t,i),this.callBase.apply(this,arguments);break;case"menuContainer":this._changeMenuOption("container",i);break;default:this.callBase.apply(this,arguments)}},_changeMenuOption:function(e,t){this._menuStrategy.widgetOption(e,t)}});r("dxToolbar",I),i.exports=I,i.exports.default=i.exports}

