name: permission_set
label: Permission Set
icon: groups
fields:
  name:
    label: Name
    type: text
    searchable: true
    index: true
    required: true
  label:
    label: Label
    type: text
    searchable: true
    index: true
    is_name: true
    required: true
  assigned_apps:
    label: Assigned Apps
    type: lookup
    multiple: true
    optionsFunction: !<tag:yaml.org,2002:js/function> |-
      function () {
              var _options;

              _options = [];

              _.forEach(Creator.Apps, function (o, k) {
                return _options.push({
                  label: o.name,
                  value: k,
                  icon: o.icon_slds
                });
              });

              return _options;
            }
    name: assigned_apps
    filterable: true
  users:
    label: Users
    type: lookup
    reference_to: users
    multiple: true
    is_wide: true
    name: users
    filterable: true
  type:
    label: Type
    type: select
    options: Profile:profile,Permission set:permission_set
    defaultValue: permission_set
  is_system:
    type: boolean
    label: 系统
    omit: true
    hidden: true
    disabled: true
list_views:
  all:
    label: All Permission Set
    filter_scope: space
    columns:
      - name
      - label
      - users
      - type
      - is_system
relatedList:
  # - objectName: permission_objects
  #   filters: !!js/function | 
  #     function(parentRecord) {
  #       return [["is_system","=",true], ["permission_set_id","=",parentRecord._id]]
  #     }
  - objectName: permission_objects
    filters: !!js/function | 
      function(parentRecord) {
        return [["is_system","<>",true], ["permission_set_id","=",parentRecord._id]]
      }
# actions:
#   standard_edit: 
#     visible: !<tag:yaml.org,2002:js/function> |-
#       function(object_name, recordId, record_permissions, record){
#         console.log('record', record);
#         if(record && record.is_custom === false){
#           return false
#         }else{
#           return record_permissions.allowEdit
#         }
#       }
#   standard_delete: 
#     label: Delete
#     visible: !<tag:yaml.org,2002:js/function> |-
#       function(object_name, recordId, record_permissions, record){
#         if(record && record.is_custom === false){
#           return false
#         }else{
#           return record_permissions.allowDelete
#         }
#       }
permission_set:
  user:
    allowCreate: false
    allowDelete: false
    allowEdit: false
    allowRead: true
    modifyAllRecords: false
    viewAllRecords: false
  admin:
    allowCreate: true
    allowDelete: true
    allowEdit: true
    allowRead: true
    modifyAllRecords: true
    viewAllRecords: true
