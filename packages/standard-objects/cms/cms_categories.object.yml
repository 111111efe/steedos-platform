name: cms_categories
icon: task
label: 栏目
fields:
  name:
    label: 名称
    type: text
    defaultValue: ''
    description: ''
    inlineHelpText: ''
    index: true
    required: true
    searchable: true
    is_wide: true
  description:
    label: 描述
    type: textarea
    rows: 3
    is_wide: true
  site:
    label: 所属站点
    type: lookup
    reference_to: cms_sites
    required: true
    sortable: true
    index: true
  parent:
    label: 上级栏目
    type: lookup
    reference_to: cms_categories
    sortable: true
    depend_on:
      - site
    optionsFunction: !!js/function |
      function (values) {
        debugger;
        if (!values || !values.site) {
          return [];
        }
        var object = Creator.getObject(values._object_name);
        if(!object){
          console.error("未找到当前对象：" + values._object_name);
          return [];
        }
        var options, result, companys, queryFilters;
        result = [];
        options = {
          $select: 'name'
        };
        queryFilters = ["site", "=", values.site];
        var steedosFilters = require("@steedos/filters");
        var odataFilter = steedosFilters.formatFiltersToODataQuery(queryFilters);
        options.$filter = odataFilter;
        companys = Creator.odata.query(values._object_name, options, true);
        companys.forEach(function (item) {
          result.push({
            label: item.name,
            value: item._id
          });
        });
        return result;
      }
  parents:
    label: 上级栏目（多层）
    type: lookup
    reference_to: cms_categories
    sortable: true
    omit: true
    hidden: true
  order:
    label: 排序号
    type: number
  # show post list on website homepage
  featured:
    type: boolean
    defaultValue: true
    hidden: true
    omit: true
list_views:
  all:
    label: 所有
    filter_scope: space
    columns:
      - name
permission_set:
  user:
    allowCreate: true
    allowDelete: true
    allowEdit: true
    allowRead: true
    modifyAllRecords: false
    viewAllRecords: true
  admin:
    allowCreate: true
    allowDelete: true
    allowEdit: true
    allowRead: true
    modifyAllRecords: true
    viewAllRecords: true